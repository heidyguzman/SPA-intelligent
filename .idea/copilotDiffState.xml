<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/narmocorp/satorispa/model/Cita.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/narmocorp/satorispa/model/Cita.kt" />
              <option name="originalContent" value="package com.narmocorp.satorispa.model&#10;&#10;import com.google.firebase.Timestamp&#10;&#10;// Modelo que representa un documento de la colección &quot;citas&quot; en Firestore&#10;data class Cita(&#10;    val id: String = &quot;&quot;,&#10;    val cliente: String = &quot;&quot;,&#10;    val cliente_id: String? = null,&#10;    val createdAt: Timestamp? = null,&#10;    val estado: String = &quot;&quot;,&#10;    val fecha: String = &quot;&quot;,&#10;    val hora: String = &quot;&quot;,&#10;    val servicio: String = &quot;&quot;,&#10;    val telefono: String = &quot;&quot;,&#10;    val terapeuta: String? = null,&#10;    val updatedAt: Timestamp? = null&#10;)&#10;&#10;" />
              <option name="updatedContent" value="package com.narmocorp.satorispa.model&#10;&#10;import com.google.firebase.Timestamp&#10;&#10;// Modelo que representa un documento de la colección &quot;citas&quot; en Firestore&#10;data class Cita(&#10;    val id: String = &quot;&quot;,&#10;    val cliente: String = &quot;&quot;,&#10;    val cliente_id: String? = null,&#10;    val createdAt: Timestamp? = null,&#10;    val estado: String = &quot;&quot;,&#10;    val fecha: String = &quot;&quot;,&#10;    val hora: String = &quot;&quot;,&#10;    val servicio: String = &quot;&quot;,&#10;    val telefono: String = &quot;&quot;,&#10;    val terapeuta: String? = null,&#10;    val updatedAt: Timestamp? = null,&#10;    val imagenServicio: String? = null // URL de la imagen del servicio (opcional)&#10;)" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/narmocorp/satorispa/views/terapeuta/TerapeutaCitasScreen.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/narmocorp/satorispa/views/terapeuta/TerapeutaCitasScreen.kt" />
              <option name="originalContent" value="package com.narmocorp.satorispa.views.terapeuta&#10;&#10;import androidx.compose.foundation.Image&#10;import androidx.compose.foundation.background&#10;import androidx.compose.foundation.clickable&#10;import androidx.compose.foundation.layout.*&#10;import androidx.compose.foundation.lazy.LazyColumn&#10;import androidx.compose.foundation.lazy.items&#10;import androidx.compose.foundation.shape.CircleShape&#10;import androidx.compose.foundation.shape.RoundedCornerShape&#10;import androidx.compose.material3.Button&#10;import androidx.compose.material3.Card&#10;import androidx.compose.material3.CircularProgressIndicator&#10;import androidx.compose.material3.MaterialTheme&#10;import androidx.compose.material3.Scaffold&#10;import androidx.compose.material3.Surface&#10;import androidx.compose.material3.Text&#10;import androidx.compose.runtime.*&#10;import androidx.compose.ui.Alignment&#10;import androidx.compose.ui.Modifier&#10;import androidx.compose.ui.draw.clip&#10;import androidx.compose.ui.graphics.Color&#10;import androidx.compose.ui.layout.ContentScale&#10;import androidx.compose.ui.res.painterResource&#10;import androidx.compose.ui.text.font.FontWeight&#10;import androidx.compose.ui.unit.dp&#10;import androidx.compose.ui.window.Dialog&#10;import androidx.navigation.NavController&#10;import com.narmocorp.satorispa.R&#10;import com.narmocorp.satorispa.controller.CitasController&#10;import com.narmocorp.satorispa.model.Cita&#10;&#10;// Pantalla &quot;Mis Citas&quot; para el usuario terapeuta. Lee datos reales desde Firestore.&#10;@Composable&#10;fun TerapeutaCitasScreen(navController: NavController) {&#10;    var citas by remember { mutableStateOf&lt;List&lt;Cita&gt;&gt;(emptyList()) }&#10;    var cargando by remember { mutableStateOf(true) }&#10;    var errorMsg by remember { mutableStateOf&lt;String?&gt;(null) }&#10;    var selectedCita by remember { mutableStateOf&lt;Cita?&gt;(null) }&#10;&#10;    // Escuchar citas en tiempo real y limpiar listener al recomponer/destruir&#10;    DisposableEffect(Unit) {&#10;        cargando = true&#10;        errorMsg = null&#10;        val registration = CitasController.escucharCitasTerapeutaRealtime(&#10;            onUpdate = { lista: List&lt;Cita&gt; -&gt;&#10;                citas = lista&#10;                cargando = false&#10;            },&#10;            onError = { mensaje: String -&gt;&#10;                errorMsg = mensaje&#10;                cargando = false&#10;            }&#10;        )&#10;&#10;        onDispose {&#10;            registration?.remove()&#10;        }&#10;    }&#10;&#10;    Scaffold(&#10;        topBar = {&#10;            TopBar(&#10;                onNavigateToNotifications = { /* implementar si hace falta */ },&#10;                onNavigateToConfig = { navController.navigate(&quot;terapeuta_config&quot;) }&#10;            )&#10;        },&#10;        bottomBar = {&#10;            NavBar(&#10;                selectedRoute = &quot;citas&quot;,&#10;                onHomeClick = { navController.navigate(&quot;terapeuta_home&quot;) },&#10;                onCitasClick = { /* No hacer nada, ya estamos aquí */ }&#10;            )&#10;        },&#10;        containerColor = MaterialTheme.colorScheme.background&#10;    ) { padding -&gt;&#10;        Column(&#10;            modifier = Modifier&#10;                .padding(padding)&#10;                .fillMaxSize()&#10;                .padding(horizontal = 24.dp, vertical = 16.dp),&#10;            horizontalAlignment = Alignment.CenterHorizontally&#10;        ) {&#10;            Text(&#10;                text = &quot;Mis Citas&quot;,&#10;                style = MaterialTheme.typography.titleLarge,&#10;                fontWeight = FontWeight.Bold,&#10;                modifier = Modifier.padding(vertical = 8.dp)&#10;            )&#10;&#10;            Spacer(modifier = Modifier.height(8.dp))&#10;&#10;            when {&#10;                cargando -&gt; {&#10;                    CircularProgressIndicator()&#10;                }&#10;                errorMsg != null -&gt; {&#10;                    Text(text = &quot;Error: ${errorMsg}&quot;)&#10;                }&#10;                citas.isEmpty() -&gt; {&#10;                    Text(text = &quot;No hay citas asignadas&quot;)&#10;                }&#10;                else -&gt; {&#10;                    LazyColumn(&#10;                        verticalArrangement = Arrangement.spacedBy(12.dp),&#10;                        modifier = Modifier.fillMaxWidth()&#10;                    ) {&#10;                        items(citas) { cita -&gt;&#10;                            CitaCard(cita) {&#10;                                selectedCita = cita&#10;                            }&#10;                        }&#10;                    }&#10;                }&#10;            }&#10;        }&#10;    }&#10;&#10;    selectedCita?.let { cita -&gt;&#10;        CitaDetailsModal(cita = cita, onDismiss = { selectedCita = null })&#10;    }&#10;}&#10;&#10;@Composable&#10;private fun CitaCard(cita: Cita, onClick: () -&gt; Unit) {&#10;    Card(&#10;        shape = RoundedCornerShape(20.dp),&#10;        modifier = Modifier&#10;            .fillMaxWidth()&#10;            .heightIn(min = 88.dp)&#10;            .background(MaterialTheme.colorScheme.surface.copy(alpha = 0.6f))&#10;            .clickable(onClick = onClick)&#10;    ) {&#10;        Row(&#10;            modifier = Modifier&#10;                .padding(12.dp)&#10;                .fillMaxWidth(),&#10;            verticalAlignment = Alignment.CenterVertically&#10;        ) {&#10;            Image(&#10;                painter = painterResource(id = R.drawable.logo),&#10;                contentDescription = cita.servicio,&#10;                modifier = Modifier&#10;                    .size(56.dp)&#10;                    .clip(CircleShape),&#10;                contentScale = ContentScale.Crop&#10;            )&#10;&#10;            Spacer(modifier = Modifier.width(12.dp))&#10;&#10;            Column(modifier = Modifier.weight(1f)) {&#10;                Text(text = cita.cliente.ifEmpty { cita.servicio }, fontWeight = FontWeight.Bold)&#10;                Spacer(modifier = Modifier.height(4.dp))&#10;                Text(text = &quot;${cita.fecha} ${cita.hora}&quot;, maxLines = 2, style = MaterialTheme.typography.bodySmall)&#10;            }&#10;&#10;            Spacer(modifier = Modifier.width(8.dp))&#10;            val statusColor = when (cita.estado.lowercase()) {&#10;                &quot;confirmada&quot; -&gt; Color(0xFF4CAF50)&#10;                &quot;pendiente&quot; -&gt; Color(0xFFFFC107)&#10;                &quot;cancelada&quot; -&gt; Color(0xFFF44336)&#10;                else -&gt; MaterialTheme.colorScheme.onSurface&#10;            }&#10;            Text(&#10;                text = cita.estado,&#10;                modifier = Modifier.padding(start = 8.dp),&#10;                color = statusColor,&#10;                fontWeight = FontWeight.Bold&#10;            )&#10;        }&#10;    }&#10;}&#10;&#10;@Composable&#10;fun CitaDetailsModal(cita: Cita, onDismiss: () -&gt; Unit) {&#10;    Dialog(onDismissRequest = onDismiss) {&#10;        Surface(&#10;            shape = RoundedCornerShape(16.dp),&#10;            color = MaterialTheme.colorScheme.surface,&#10;            modifier = Modifier.padding(16.dp)&#10;        ) {&#10;            Column(&#10;                modifier = Modifier.padding(16.dp),&#10;                horizontalAlignment = Alignment.Start&#10;            ) {&#10;                Text(&#10;                    text = &quot;Detalles de la Cita&quot;,&#10;                    style = MaterialTheme.typography.titleLarge,&#10;                    fontWeight = FontWeight.Bold,&#10;                    modifier = Modifier.align(Alignment.CenterHorizontally)&#10;                )&#10;                Spacer(modifier = Modifier.height(16.dp))&#10;                Text(text = &quot;Servicio: ${cita.servicio}&quot;)&#10;                Spacer(modifier = Modifier.height(8.dp))&#10;                Text(text = &quot;Cliente: ${cita.cliente}&quot;)&#10;                Spacer(modifier = Modifier.height(8.dp))&#10;                Text(text = &quot;Fecha: ${cita.fecha}&quot;)&#10;                Spacer(modifier = Modifier.height(8.dp))&#10;                Text(text = &quot;Hora: ${cita.hora}&quot;)&#10;                Spacer(modifier = Modifier.height(8.dp))&#10;                Row {&#10;                    Text(text = &quot;Estado: &quot;)&#10;                    val statusColor = when (cita.estado.lowercase()) {&#10;                        &quot;confirmada&quot; -&gt; Color(0xFF4CAF50)&#10;                        &quot;pendiente&quot; -&gt; Color(0xFFFFC107)&#10;                        &quot;cancelada&quot; -&gt; Color(0xFFF44336)&#10;                        else -&gt; MaterialTheme.colorScheme.onSurface&#10;                    }&#10;                    Text(text = cita.estado, color = statusColor, fontWeight = FontWeight.Bold)&#10;                }&#10;                Spacer(modifier = Modifier.height(16.dp))&#10;                Button(&#10;                    onClick = onDismiss,&#10;                    modifier = Modifier.align(Alignment.CenterHorizontally)&#10;                ) {&#10;                    Text(&quot;Cerrar&quot;)&#10;                }&#10;            }&#10;        }&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package com.narmocorp.satorispa.views.terapeuta&#10;&#10;import androidx.compose.foundation.Image&#10;import androidx.compose.foundation.background&#10;import androidx.compose.foundation.clickable&#10;import androidx.compose.foundation.layout.*&#10;import androidx.compose.foundation.lazy.LazyColumn&#10;import androidx.compose.foundation.lazy.items&#10;import androidx.compose.foundation.shape.CircleShape&#10;import androidx.compose.foundation.shape.RoundedCornerShape&#10;import androidx.compose.material3.Button&#10;import androidx.compose.material3.Card&#10;import androidx.compose.material3.CircularProgressIndicator&#10;import androidx.compose.material3.MaterialTheme&#10;import androidx.compose.material3.Scaffold&#10;import androidx.compose.material3.Surface&#10;import androidx.compose.material3.Text&#10;import androidx.compose.runtime.*&#10;import androidx.compose.ui.Alignment&#10;import androidx.compose.ui.Modifier&#10;import androidx.compose.ui.draw.clip&#10;import androidx.compose.ui.graphics.Color&#10;import androidx.compose.ui.layout.ContentScale&#10;import androidx.compose.ui.res.painterResource&#10;import androidx.compose.ui.text.font.FontWeight&#10;import androidx.compose.ui.unit.dp&#10;import androidx.compose.ui.window.Dialog&#10;import androidx.navigation.NavController&#10;import coil.compose.AsyncImage&#10;import com.narmocorp.satorispa.R&#10;import com.narmocorp.satorispa.controller.CitasController&#10;import com.narmocorp.satorispa.model.Cita&#10;&#10;// Pantalla &quot;Mis Citas&quot; para el usuario terapeuta. Lee datos reales desde Firestore.&#10;@Composable&#10;fun TerapeutaCitasScreen(navController: NavController) {&#10;    var citas by remember { mutableStateOf&lt;List&lt;Cita&gt;&gt;(emptyList()) }&#10;    var cargando by remember { mutableStateOf(true) }&#10;    var errorMsg by remember { mutableStateOf&lt;String?&gt;(null) }&#10;    var selectedCita by remember { mutableStateOf&lt;Cita?&gt;(null) }&#10;&#10;    // Escuchar citas en tiempo real y limpiar listener al recomponer/destruir&#10;    DisposableEffect(Unit) {&#10;        cargando = true&#10;        errorMsg = null&#10;        val registration = CitasController.escucharCitasTerapeutaRealtime(&#10;            onUpdate = { lista: List&lt;Cita&gt; -&gt;&#10;                citas = lista&#10;                cargando = false&#10;            },&#10;            onError = { mensaje: String -&gt;&#10;                errorMsg = mensaje&#10;                cargando = false&#10;            }&#10;        )&#10;&#10;        onDispose {&#10;            registration?.remove()&#10;        }&#10;    }&#10;&#10;    Scaffold(&#10;        topBar = {&#10;            TopBar(&#10;                onNavigateToNotifications = { /* implementar si hace falta */ },&#10;                onNavigateToConfig = { navController.navigate(&quot;terapeuta_config&quot;) }&#10;            )&#10;        },&#10;        bottomBar = {&#10;            NavBar(&#10;                selectedRoute = &quot;citas&quot;,&#10;                onHomeClick = { navController.navigate(&quot;terapeuta_home&quot;) },&#10;                onCitasClick = { /* No hacer nada, ya estamos aquí */ }&#10;            )&#10;        },&#10;        containerColor = MaterialTheme.colorScheme.background&#10;    ) { padding -&gt;&#10;        Column(&#10;            modifier = Modifier&#10;                .padding(padding)&#10;                .fillMaxSize()&#10;                .padding(horizontal = 24.dp, vertical = 16.dp),&#10;            horizontalAlignment = Alignment.CenterHorizontally&#10;        ) {&#10;            Text(&#10;                text = &quot;Mis Citas&quot;,&#10;                style = MaterialTheme.typography.titleLarge,&#10;                fontWeight = FontWeight.Bold,&#10;                modifier = Modifier.padding(vertical = 8.dp)&#10;            )&#10;&#10;            Spacer(modifier = Modifier.height(8.dp))&#10;&#10;            when {&#10;                cargando -&gt; {&#10;                    CircularProgressIndicator()&#10;                }&#10;                errorMsg != null -&gt; {&#10;                    Text(text = &quot;Error: ${errorMsg}&quot;)&#10;                }&#10;                citas.isEmpty() -&gt; {&#10;                    Text(text = &quot;No hay citas asignadas&quot;)&#10;                }&#10;                else -&gt; {&#10;                    LazyColumn(&#10;                        verticalArrangement = Arrangement.spacedBy(12.dp),&#10;                        modifier = Modifier.fillMaxWidth()&#10;                    ) {&#10;                        items(citas) { cita -&gt;&#10;                            CitaCard(cita) {&#10;                                selectedCita = cita&#10;                            }&#10;                        }&#10;                    }&#10;                }&#10;            }&#10;        }&#10;    }&#10;&#10;    selectedCita?.let { cita -&gt;&#10;        CitaDetailsModal(cita = cita, onDismiss = { selectedCita = null })&#10;    }&#10;}&#10;&#10;@Composable&#10;private fun CitaCard(cita: Cita, onClick: () -&gt; Unit) {&#10;    Card(&#10;        shape = RoundedCornerShape(20.dp),&#10;        modifier = Modifier&#10;            .fillMaxWidth()&#10;            .heightIn(min = 88.dp)&#10;            .background(MaterialTheme.colorScheme.surface.copy(alpha = 0.6f))&#10;            .clickable(onClick = onClick)&#10;    ) {&#10;        Row(&#10;            modifier = Modifier&#10;                .padding(12.dp)&#10;                .fillMaxWidth(),&#10;            verticalAlignment = Alignment.CenterVertically&#10;        ) {&#10;            if (!cita.imagenServicio.isNullOrEmpty()) {&#10;                AsyncImage(&#10;                    model = cita.imagenServicio,&#10;                    contentDescription = cita.servicio,&#10;                    modifier = Modifier&#10;                        .size(56.dp)&#10;                        .clip(CircleShape),&#10;                    contentScale = ContentScale.Crop,&#10;                    error = painterResource(id = R.drawable.logo),&#10;                    placeholder = painterResource(id = R.drawable.logo)&#10;                )&#10;            } else {&#10;                Image(&#10;                    painter = painterResource(id = R.drawable.logo),&#10;                    contentDescription = cita.servicio,&#10;                    modifier = Modifier&#10;                        .size(56.dp)&#10;                        .clip(CircleShape),&#10;                    contentScale = ContentScale.Crop&#10;                )&#10;            }&#10;&#10;            Spacer(modifier = Modifier.width(12.dp))&#10;&#10;            Column(modifier = Modifier.weight(1f)) {&#10;                Text(text = cita.cliente.ifEmpty { cita.servicio }, fontWeight = FontWeight.Bold)&#10;                Spacer(modifier = Modifier.height(4.dp))&#10;                Text(text = &quot;${cita.fecha} ${cita.hora}&quot;, maxLines = 2, style = MaterialTheme.typography.bodySmall)&#10;            }&#10;&#10;            Spacer(modifier = Modifier.width(8.dp))&#10;            val statusColor = when (cita.estado.lowercase()) {&#10;                &quot;confirmada&quot; -&gt; Color(0xFF4CAF50)&#10;                &quot;pendiente&quot; -&gt; Color(0xFFFFC107)&#10;                &quot;cancelada&quot; -&gt; Color(0xFFF44336)&#10;                else -&gt; MaterialTheme.colorScheme.onSurface&#10;            }&#10;            Text(&#10;                text = cita.estado,&#10;                modifier = Modifier.padding(start = 8.dp),&#10;                color = statusColor,&#10;                fontWeight = FontWeight.Bold&#10;            )&#10;        }&#10;    }&#10;}&#10;&#10;@Composable&#10;fun CitaDetailsModal(cita: Cita, onDismiss: () -&gt; Unit) {&#10;    Dialog(onDismissRequest = onDismiss) {&#10;        Surface(&#10;            shape = RoundedCornerShape(16.dp),&#10;            color = MaterialTheme.colorScheme.surface,&#10;            modifier = Modifier.padding(16.dp)&#10;        ) {&#10;            Column(&#10;                modifier = Modifier.padding(16.dp),&#10;                horizontalAlignment = Alignment.Start&#10;            ) {&#10;                Text(&#10;                    text = &quot;Detalles de la Cita&quot;,&#10;                    style = MaterialTheme.typography.titleLarge,&#10;                    fontWeight = FontWeight.Bold,&#10;                    modifier = Modifier.align(Alignment.CenterHorizontally)&#10;                )&#10;                Spacer(modifier = Modifier.height(16.dp))&#10;&#10;                if (!cita.imagenServicio.isNullOrEmpty()) {&#10;                    AsyncImage(&#10;                        model = cita.imagenServicio,&#10;                        contentDescription = cita.servicio,&#10;                        modifier = Modifier&#10;                            .height(80.dp)&#10;                            .fillMaxWidth()&#10;                            .clip(RoundedCornerShape(8.dp)),&#10;                        contentScale = ContentScale.Crop,&#10;                        placeholder = painterResource(id = R.drawable.logo),&#10;                        error = painterResource(id = R.drawable.logo)&#10;                    )&#10;                    Spacer(modifier = Modifier.height(12.dp))&#10;                }&#10;&#10;                Text(text = &quot;Servicio: ${cita.servicio}&quot;)&#10;                Spacer(modifier = Modifier.height(8.dp))&#10;                Text(text = &quot;Cliente: ${cita.cliente}&quot;)&#10;                Spacer(modifier = Modifier.height(8.dp))&#10;                Text(text = &quot;Fecha: ${cita.fecha}&quot;)&#10;                Spacer(modifier = Modifier.height(8.dp))&#10;                Text(text = &quot;Hora: ${cita.hora}&quot;)&#10;                Spacer(modifier = Modifier.height(8.dp))&#10;                Row {&#10;                    Text(text = &quot;Estado: &quot;)&#10;                    val statusColor = when (cita.estado.lowercase()) {&#10;                        &quot;confirmada&quot; -&gt; Color(0xFF4CAF50)&#10;                        &quot;pendiente&quot; -&gt; Color(0xFFFFC107)&#10;                        &quot;cancelada&quot; -&gt; Color(0xFFF44336)&#10;                        else -&gt; MaterialTheme.colorScheme.onSurface&#10;                    }&#10;                    Text(text = cita.estado, color = statusColor, fontWeight = FontWeight.Bold)&#10;                }&#10;                Spacer(modifier = Modifier.height(16.dp))&#10;                Button(&#10;                    onClick = onDismiss,&#10;                    modifier = Modifier.align(Alignment.CenterHorizontally)&#10;                ) {&#10;                    Text(&quot;Cerrar&quot;)&#10;                }&#10;            }&#10;        }&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>